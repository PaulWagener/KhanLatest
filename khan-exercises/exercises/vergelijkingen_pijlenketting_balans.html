<!DOCTYPE html>
<html data-translatable data-require="math math-format simplify graphie">
<head>
    <meta charset="UTF-8" />
    <title>Formules korter</title>
    <script src="../khan-exercise.js"></script>
    <script type="text/javascript">

    /**
     * Show a graphic like:
     *      +4       x3
     * ... ---) ... ---) 18
     * Where +4 is the first operation, x3 the second operation, 18 the label and the direction of the arrows 'reverse'.
     */
    function PijlenKetting(firstOperation, secondOperation, outputLabel, reverse) {
        with(KhanUtil.currentGraph) {
            init({
                range: [[-0.2, 2.2], [-0.2, 0.2]],
                scale: [120, 120]
            });

            label([ 0, 0], "\\ldots");
            label([ 1, 0], "\\ldots");
            label([ 2, 0], outputLabel);
    
            label([0.5, 0.1], firstOperation);
            label([1.5, 0.1], secondOperation);
    
            style({
                arrows: "-&gt;"
            }, function() {
                // Arrows
                var arrowSpacing = 0.15;
                if(reverse) {
                    line([1 - arrowSpacing, 0], [arrowSpacing, 0]);
                    line([2 - arrowSpacing, 0], [1 + arrowSpacing, 0]);
                } else {
                    line([0 + arrowSpacing, 0], [1 - arrowSpacing, 0]);
                    line([1 + arrowSpacing, 0], [2 - arrowSpacing, 0]);
                }
            });
        }
    }
    
    function formatOperation(operation) {
        var op = KhanUtil.exprClone(operation);
        
        // Prepend invisible something so that the operation is formatted '\times 4' instead of just '4'
        op.args.unshift({op: "empty", args: []}); 
        return KhanUtil.format(op);
    }
    
    /**
     * 
     */
    function inverseOperation(operation) {
        var inverseOp = KhanUtil.exprClone(operation);
        if (inverseOp.op == "+") {
            inverseOp.args[0] = -inverseOp.args[0];
        } else if(inverseOp.op == "*") {
            inverseOp.op = "div";
        }
        return inverseOp;
    }
    
    function combineOperation(firstArg, operation1, operation2, firstArgInFront, secondArgInFront) {
        combined = KhanUtil.exprClone(operation2);
        firstOperation = KhanUtil.exprClone(operation1);
        if(firstArgInFront) {
            firstOperation.args.unshift(firstArg);
        } else {
            firstOperation.args.push(firstArg);
        }
        firstOperation = {op: "()", args: [firstOperation]};
        
        combined.args.unshift(firstOperation);
        return KhanUtil.simplify(combined);
    }
    
    </script
</head>
<body>
    <div class="exercise">

        <div class="vars">
            <var id="letter">shuffle("abcdefghijklmnpqrstuvwxyz")[0]</var>
            <var id="A">randRangeExclude(-5, 10, [-1, 0, 1])</var>
            <var id="B">randRangeExclude(-5, 10, [-1, 0, 1])</var>
            <var id="x">randRange(1, 10)</var>
            <var id="firstArgInFront">randRange(0, 1) == 0</var>
        </div>

        <div class="question">
            <p>Los de vergelijking op met de pijlenketting</p>
            <p><code><var>format(combineOperation({op: "var", args: letter}, operation1, operation2, firstArgInFront))</var> = <var>constant</var></code></p>

            <p>Maak bij de vergelijking een pijlenketting</p>
            <div class="graphie">PijlenKetting(formatOperation(operation1), formatOperation(operation2), constant)</div>

            <p>Maak de omgekeerde pijlenketting</p>
            <div class="graphie">PijlenKetting(formatOperation(inverseOperation(operation1)), formatOperation(inverseOperation(operation2)), constant, true)</div>

            <p>Bereken de oplossing <code><var>format(combineOperation(constant, inverseOperation(operation2), inverseOperation(operation1), true))</var> = <var>x</var></code></p>
        </div>
        <div class="hints">
            
        </div>


        <div class="problems">
            <div id="multiplication-first">
                <div class="vars">
                    <var id="operation1">{op: "*", args: [A]}</var>
                    <var id="operation2">{op: "+", args: [B]}</var>
                    <var id="constant">A*x + B</var>
                </div>
            </div>
            <div id="addition-first">
                <div class="vars">
                    <var id="operation1">{op: "+", args: [A]}</var>
                    <var id="operation2">{op: "*", args: [B]}</var>
                    <var id="constant">(A+x) * B</var>
                </div>
            </div>
        </div>

        <div class="solution" data-forms="integer"><var>x</var></div>

    </div>
</body>
</html>

